<script>window.app=app={db:{}
,selection:{top:5,yr:2015//,ward:'both'
	,yrs:[2009,2010,2011,2012,2013,2014,2015]
	,tps:['Top 1','Top 2','Top 3','Top 4'
		,'Top 5','Top 6','Top 7','Top 8'
		,'Top 9','Top 10','Top 15','Top 20'
		,'Top 25','Top 30','All']
	,tops:[1,2,3,4,5,10,15,20,25,30,'All']
	,w:['inward','outward']
	,lbl:{inward:
		 'Kuwait Inward Direct Investment Positions US Dollars, by All Reporting Economies Cross-classified by Counterpart Economies\n<br/>US Dollars, Millions'
		,outward:
		'Kuwait Outward Direct Investment Positions US Dollars, by All Reporting Economies Cross-classified by Counterpart Economies\n<br/>US Dollars, Millions'
		}
	,dbYr:{}
	}//selection
,ll:{KWT: [47.481766,29.31166]
/*[51.31491712707182, 28.675613142120646] 
[47.53157290470723, 29.659253153467677] 
d3.select("svg").on("mousedown.log", function() {
  console.log(app.outwardmap.projection.invert(d3.mouse(this)));
});
*/
,SAU:[45.0516647531573, 25.6331128978041] // [43.398392652124,25.259893111244978]
,USA:[-97.95637198622273,40.454128003454606]
,CYM:[-81,19]//19°20′N 81°24′W
,IRQ:[43.398392652124, 33.874396628268]
,IND:[76.94505494505495, 24.056597610029684]
,TUR:[30.584415584415584, 40.001134503047126]
,BHR:[49.675324675324674, 27.408718346547204]
,OMN:[57.467532467532465, 22.104369952877093]
,ARE:[53.57142857142858, 24.253166994982926]
,QAT:[51.23376623376623, 26.366263943112013]
,JEY:[-3.362637362637363, 49.30880883711452]
,TUN:[9.692307692307693, 36.00749766531932]
,FRA:[1.3846153846153848, 47.47014259876448]
,EGY:[30.263736263736266, 30.042083637816763]
,SDN:[32.637362637362635, 19.278955157180555]
,HKG:[122.43956043956045, 30.383948481875183]
,KOR:[127.18681318681318, 36.32686762990563]
,JOR:[36.1978021978022, 31.064094926220353]
,NLD:[5.340659340659341, 52.54854348648246]
,GBR:[-0.9890109890109889, 52.54854348648246]
,CAN:[-102.26373626373626, 56.885022644639896]
,DEU:[9.692307692307693, 52.307320988231716]
,MYS:[9.692307692307693, 52.307320988231716]
,IRN:[53.604395604395606, 33.406200586253725]
,DZA:[2.5714285714285716, 30.383948481875183]
,MAR:[-7.318681318681319, 33.075328002018686]
,LBN:[35.80219780219781, 34.06417343571554]
,PAK:[69.82417582417582, 31.064094926220353]
,MRT:[-10.483516483516484, 21.871259614612644]
,SYR:[37.78021978021978, 35.36486555009878]
,NOR:[23.934065934065938, 69.91016881788353]
,IDN:[113.73626373626375, -0.5224207641110183]
,JPN:[138.65934065934067, 36.64493397815583]
,CHE:[7.714285714285714, 46.932583045058045]
,IMN:[-5.736263736263736, 53.73493857398516]
,MLT:[13.64835164835165, 36.32686762990563]
,MDV:[72.59340659340658, 6.190765619314675]
,GGY:[-2.585278,49.465691]
,PSE:[34.308825,31.354676]
,BEL:[4.469936,50.503887]
,PAN:[-79.31868131868133, 9.326223697137353]
/*
,IMN:
,BHS:
,SGP:
,AZE:
,DNK:
,ZAF:
,LUX:
,VGB:
,CHN:
/*
country	latitude	longitude	name
AD		42.546245	1.601554	Andorra
AE	ARE	23.424076	53.847818	United Arab Emirates
AF		33.93911	67.709953	Afghanistan
AG		17.060816	-61.796428	Antigua and Barbuda
AI		18.220554	-63.068615	Anguilla
AL		41.153332	20.168331	Albania
AM		40.069099	45.038189	Armenia
AN		12.226079	-69.060087	Netherlands Antilles
AO		-11.202692	17.873887	Angola
AQ		-75.250973	-0.071389	Antarctica
AR		-38.416097	-63.616672	Argentina
AS		-14.270972	-170.132217	American Samoa
AT		47.516231	14.550072	Austria
AU		-25.274398	133.775136	Australia
AW		12.52111	-69.968338	Aruba
AZ	AZE	40.143105	47.576927	Azerbaijan
BA		43.915886	17.679076	Bosnia and Herzegovina
BB		13.193887	-59.543198	Barbados
BD		23.684994	90.356331	Bangladesh
BE	BEL	50.503887	4.469936	Belgium
BF		12.238333	-1.561593	Burkina Faso
BG		42.733883	25.48583	Bulgaria
BH	BHR	25.930414	50.637772	Bahrain
BI		-3.373056	29.918886	Burundi
BJ		9.30769	2.315834	Benin
BM		32.321384	-64.75737	Bermuda
BN		4.535277	114.727669	Brunei
BO		-16.290154	-63.588653	Bolivia
BR		-14.235004	-51.92528	Brazil
BS	BHS	25.03428	-77.39628	Bahamas
BT		27.514162	90.433601	Bhutan
BV		-54.423199	3.413194	Bouvet Island
BW		-22.328474	24.684866	Botswana
BY		53.709807	27.953389	Belarus
BZ		17.189877	-88.49765	Belize
CA	CAN	56.130366	-106.346771	Canada
CC		-12.164165	96.870956	Cocos [Keeling] Islands
CD		-4.038333	21.758664	Congo [DRC]
CF		6.611111	20.939444	Central African Republic
CG		-0.228021	15.827659	Congo [Republic]
CH	CHE	46.818188	8.227512	Switzerland
CI		7.539989	-5.54708	Côte d'Ivoire
CK		-21.236736	-159.777671	Cook Islands
CL		-35.675147	-71.542969	Chile
CM		7.369722	12.354722	Cameroon
CN	CHN	35.86166	104.195397	China
CO		4.570868	-74.297333	Colombia
CR		9.748917	-83.753428	Costa Rica
CU		21.521757	-77.781167	Cuba
CV		16.002082	-24.013197	Cape Verde
CX		-10.447525	105.690449	Christmas Island
CY		35.126413	33.429859	Cyprus
CZ		49.817492	15.472962	Czech Republic
DE	DEU	51.165691	10.451526	Germany
DJ		11.825138	42.590275	Djibouti
DK	DNK	56.26392	9.501785	Denmark
DM		15.414999	-61.370976	Dominica
DO		18.735693	-70.162651	Dominican Republic
DZ	DZA	28.033886	1.659626	Algeria
EC		-1.831239	-78.183406	Ecuador
EE		58.595272	25.013607	Estonia
EG	EGY	26.820553	30.802498	Egypt
EH		24.215527	-12.885834	Western Sahara
ER		15.179384	39.782334	Eritrea
ES		40.463667	-3.74922	Spain
ET		9.145	40.489673	Ethiopia
FI		61.92411	25.748151	Finland
FJ		-16.578193	179.414413	Fiji
FK		-51.796253	-59.523613	Falkland Islands [Islas Malvinas]
FM		7.425554	150.550812	Micronesia
FO		61.892635	-6.911806	Faroe Islands
FR	FRA	46.227638	2.213749	France
GA		-0.803689	11.609444	Gabon
GB	GBR	55.378051	-3.435973	United Kingdom
GD		12.262776	-61.604171	Grenada
GE		42.315407	43.356892	Georgia
GF		3.933889	-53.125782	French Guiana
GG	GGY	49.465691	-2.585278	Guernsey
GH		7.946527	-1.023194	Ghana
GI		36.137741	-5.345374	Gibraltar
GL		71.706936	-42.604303	Greenland
GM		13.443182	-15.310139	Gambia
GN		9.945587	-9.696645	Guinea
GP		16.995971	-62.067641	Guadeloupe
GQ		1.650801	10.267895	Equatorial Guinea
GR		39.074208	21.824312	Greece
GS		-54.429579	-36.587909	South Georgia and the South Sandwich Islands
GT		15.783471	-90.230759	Guatemala
GU		13.444304	144.793731	Guam
GW		11.803749	-15.180413	Guinea-Bissau
GY		4.860416	-58.93018	Guyana
GZ		31.354676	34.308825	Gaza Strip
HK	HKG	22.396428	114.109497	Hong Kong
HM		-53.08181	73.504158	Heard Island and McDonald Islands
HN		15.199999	-86.241905	Honduras
HR		45.1	15.2	Croatia
HT		18.971187	-72.285215	Haiti
HU		47.162494	19.503304	Hungary
ID	IDN	-0.789275	113.921327	Indonesia
IE		53.41291	-8.24389	Ireland
IL		31.046051	34.851612	Israel
IM	IMN	54.236107	-4.548056	Isle of Man
IN	IND	20.593684	78.96288	India
IO		-6.343194	71.876519	British Indian Ocean Territory
IQ	IRQ	33.223191	43.679291	Iraq
IR	IRN	32.427908	53.688046	Iran
IS		64.963051	-19.020835	Iceland
IT		41.87194	12.56738	Italy
JE	JEY	49.214439	-2.13125	Jersey
JM		18.109581	-77.297508	Jamaica
JO	JOR	30.585164	36.238414	Jordan
JP	JPN	36.204824	138.252924	Japan
KE		-0.023559	37.906193	Kenya
KG		41.20438	74.766098	Kyrgyzstan
KH		12.565679	104.990963	Cambodia
KI		-3.370417	-168.734039	Kiribati
KM		-11.875001	43.872219	Comoros
KN		17.357822	-62.782998	Saint Kitts and Nevis
KP		40.339852	127.510093	North Korea
KR	KOR	35.907757	127.766922	South Korea
KW		29.31166	47.481766	Kuwait
KY	CYM	19.513469	-80.566956	Cayman Islands
KZ		48.019573	66.923684	Kazakhstan
LA		19.85627	102.495496	Laos
LB	LBN	33.854721	35.862285	Lebanon
LC		13.909444	-60.978893	Saint Lucia
LI		47.166	9.555373	Liechtenstein
LK		7.873054	80.771797	Sri Lanka
LR		6.428055	-9.429499	Liberia
LS		-29.609988	28.233608	Lesotho
LT		55.169438	23.881275	Lithuania
LU	LUX	49.815273	6.129583	Luxembourg
LV		56.879635	24.603189	Latvia
LY		26.3351	17.228331	Libya
MA	MAR	31.791702	-7.09262	Morocco
MC		43.750298	7.412841	Monaco
MD		47.411631	28.369885	Moldova
ME		42.708678	19.37439	Montenegro
MG		-18.766947	46.869107	Madagascar
MH		7.131474	171.184478	Marshall Islands
MK		41.608635	21.745275	Macedonia [FYROM]
ML		17.570692	-3.996166	Mali
MM		21.913965	95.956223	Myanmar [Burma]
MN		46.862496	103.846656	Mongolia
MO		22.198745	113.543873	Macau
MP		17.33083	145.38469	Northern Mariana Islands
MQ		14.641528	-61.024174	Martinique
MR	MRT	21.00789	-10.940835	Mauritania
MS		16.742498	-62.187366	Montserrat
MT	MLT	35.937496	14.375416	Malta
MU		-20.348404	57.552152	Mauritius
MV	MDV	3.202778	73.22068	Maldives
MW		-13.254308	34.301525	Malawi
MX		23.634501	-102.552784	Mexico
MY	MYS	4.210484	101.975766	Malaysia
MZ		-18.665695	35.529562	Mozambique
NA		-22.95764	18.49041	Namibia
NC		-20.904305	165.618042	New Caledonia
NE		17.607789	8.081666	Niger
NF		-29.040835	167.954712	Norfolk Island
NG		9.081999	8.675277	Nigeria
NI		12.865416	-85.207229	Nicaragua
NL	NLD	52.132633	5.291266	Netherlands
NO	NOR	60.472024	8.468946	Norway
NP		28.394857	84.124008	Nepal
NR		-0.522778	166.931503	Nauru
NU		-19.054445	-169.867233	Niue
NZ		-40.900557	174.885971	New Zealand
OM	OMN	21.512583	55.923255	Oman
PA		8.537981	-80.782127	Panama
PE		-9.189967	-75.015152	Peru
PF		-17.679742	-149.406843	French Polynesia
PG		-6.314993	143.95555	Papua New Guinea
PH		12.879721	121.774017	Philippines
PK	PAK	30.375321	69.345116	Pakistan
PL		51.919438	19.145136	Poland
PM		46.941936	-56.27111	Saint Pierre and Miquelon
PN		-24.703615	-127.439308	Pitcairn Islands
PR		18.220833	-66.590149	Puerto Rico
PS	PSE	31.952162	35.233154	Palestinian Territories
PT		39.399872	-8.224454	Portugal
PW		7.51498	134.58252	Palau
PY		-23.442503	-58.443832	Paraguay
QA	QAT	25.354826	51.183884	Qatar
RE		-21.115141	55.536384	Réunion
RO		45.943161	24.96676	Romania
RS		44.016521	21.005859	Serbia
RU		61.52401	105.318756	Russia
RW		-1.940278	29.873888	Rwanda
SA	SAU	23.885942	45.079162	Saudi Arabia
SB		-9.64571	160.156194	Solomon Islands
SC		-4.679574	55.491977	Seychelles
SD	SDN	12.862807	30.217636	Sudan
SE		60.128161	18.643501	Sweden
SG	SGP	1.352083	103.819836	Singapore
SH		-24.143474	-10.030696	Saint Helena
SI		46.151241	14.995463	Slovenia
SJ		77.553604	23.670272	Svalbard and Jan Mayen
SK		48.669026	19.699024	Slovakia
SL		8.460555	-11.779889	Sierra Leone
SM		43.94236	12.457777	San Marino
SN		14.497401	-14.452362	Senegal
SO		5.152149	46.199616	Somalia
SR		3.919305	-56.027783	Suriname
ST		0.18636	6.613081	São Tomé and Príncipe
SV		13.794185	-88.89653	El Salvador
SY	SYR	34.802075	38.996815	Syria
SZ		-26.522503	31.465866	Swaziland
TC		21.694025	-71.797928	Turks and Caicos Islands
TD		15.454166	18.732207	Chad
TF		-49.280366	69.348557	French Southern Territories
TG		8.619543	0.824782	Togo
TH		15.870032	100.992541	Thailand
TJ		38.861034	71.276093	Tajikistan
TK		-8.967363	-171.855881	Tokelau
TL		-8.874217	125.727539	Timor-Leste
TM		38.969719	59.556278	Turkmenistan
TN	TUN	33.886917	9.537499	Tunisia
TO		-21.178986	-175.198242	Tonga
TR	TUR	38.963745	35.243322	Turkey
TT		10.691803	-61.222503	Trinidad and Tobago
TV		-7.109535	177.64933	Tuvalu
TW		23.69781	120.960515	Taiwan
TZ		-6.369028	34.888822	Tanzania
UA		48.379433	31.16558	Ukraine
UG		1.373333	32.290275	Uganda
UM			U.S. Minor Outlying Islands
US	USA	37.09024	-95.712891	United States
UY		-32.522779	-55.765835	Uruguay
UZ		41.377491	64.585262	Uzbekistan
VA		41.902916	12.453389	Vatican City
VC		12.984305	-61.287228	Saint Vincent and the Grenadines
VE		6.42375	-66.58973	Venezuela
VG	VGB	18.420695	-64.639968	British Virgin Islands
VI		18.335765	-64.896335	U.S. Virgin Islands
VN		14.058324	108.277199	Vietnam
VU		-15.376706	166.959158	Vanuatu
WF		-13.768752	-177.156097	Wallis and Futuna
WS		-13.759029	-172.104629	Samoa
XK		42.602636	20.902977	Kosovo
YE		15.552727	48.516388	Yemen
YT		-12.8275	45.166244	Mayotte
ZA	ZAF	-30.559482	22.937506	South Africa
ZM		-13.133897	27.849332	Zambia
ZW		-19.015438	29.154857	Zimbabwe
*/
}
,initDB:function initDB(){
 var db=app.db={}, pres=document.getElementsByTagName('pre')
 for(var pi=0;pi<pres.length;pi++){
	var txt=pres[pi].innerHTML
	,lns=txt.split('\n')
	,yrs=lns[0].split('\t')
	,sheet=db[pres[pi].id]={countries:{count:0}}//the sheet will have year-values as prop-key-name
		//countries:props:<cntry>:{count:<int:yearsCount>,total:<num:right-most-column>}
	,l1=lns[1].split('\t')
	for(var lni=2;lni<lns.length;lni++){
		var ln=lns[lni];if(ln){var
		cols=ln.split('\t'),c
		,cntry=cols[0]
		,cn=cols.length
		,iso=cols[cn-1]
		,w=cntry=='World'
		,w1=lni<lns.length-3
		if(w1||w){if(!w){
			c=sheet.countries[iso]={count:0,Value:cols[cn-2],iso:iso,name:cntry}
			sheet.countries.count++;}
		 for(var ci=1;ci<cols.length-2;ci+=3){
			var v=cols[ci],yr=yrs[ci],dbYr=sheet[yr];
			if(yr&&v){if(w)
					dbYr.World.Value=v;//if(n=='Rank')y[n]=dbYr.World.cntrsCount;else if(v)dbYr.World[n]=v;
				else{
				c.count++
				var i=ci+2,n=l1[i]
					,y={cntry:cntry,iso:iso};v=cols[i];
				if(!dbYr)dbYr=sheet[yr]={World:{cntrsCount:0,Value:0}}
				dbYr[v]=y;
				dbYr.World.cntrsCount++//if(cntry!='World')
				for(var vi=0;vi<3;vi++)
				{i=ci+vi;n=l1[i];v=cols[i];
					if(n&&v)y[n]=v;
	}}}}}}}}
	/*investment json-db
	inward/outward
		<year>
			<rank>:{name:<str:countryName> , value:<str:number> , percentage:<str:number>,Rank:<int>}
			<"World" year-total >:{val:<str:number>,other:<str:number>}	
		"countries"
	*/return db;}//initDB

,generate:function generate(){var sel=app.selection
 sel.w.map(function f(w)
 {var //p=d3.select(w)
	y=sel.dbYr[w]=app.db[w][sel.yr]
	document.getElementById(w+'H').innerHTML=
		sel.lbl[w]+', '+sel.yr
		+(!sel.top||sel.top=='All'?'':', Top:'+sel.top)
	//if(!tp||tp=='All')tp=y.World.cntrsCount
	app.db2tbl(sel.yr,w,sel.top)
	app.db2Map(sel.yr,w,sel.top)})
}//generate

,menuChanged:function menuChanged() {
    var x=d3.event.target,selectedValue = x.value,nm=x.name;
	app.selection[nm]=selectedValue
	console.log('selectedValue',app.selection)
	app.generate();
}//menuChanged

,db2tbl:function db2tbl(yr,wrd,tp){
	var div=document.getElementById(wrd+'Tbl')
	,b=['<table><tr>']
	, y=app.selection.dbYr[wrd],w=y.World
	, columns = [
		{ head: 'ISO', cl: 'text' ,j:'iso'},
		{ head: 'Country', cl: 'title' ,j:'cntry'},
		{ head: 'Rank', cl: 'num' ,j:'Rank'},
		{ head: '%', cl: 'num' ,j:'%'},//Percentage
		{ head: 'Value', cl: 'num' ,j:'Value'}];
	if(!tp)tp=app.selection.top
	for(var col=0;col<columns.length;col++){var x=columns[col]
		b.push('<th class="',x.cl,'">',x.head,'</th>');}
	b.push('</tr><tr>')

	if(!tp||tp=='All')tp=w.cntrsCount
	for(var i=1;i<=tp;i++){
		var c=y[i];
		b.push('<tr id="tr-',wrd,'-',c&&c.iso,'" onmouseover="console.log(\'over-tr:\',arguments)">')	
		if(c)
		for(var col=0;col<columns.length;col++){var x=columns[col]
			b.push('<td class="',x.cl,'" id="td-',col,'-',wrd,'-',c.iso,'">',c[x.j],'</td>');}
		b.push('</tr>')	
	}
	b.push('</table>')
	div.innerHTML=b.join('')
 }//db2tbl

 ,db2Map: function db2Map(yr,wrd,tp){
	var sel=app.selection
	,dy=sel.dbYr[wrd]
	,w=dy.World
	,out=wrd=='outward'
	,clr=sel.clr;
	if(tp=='All')tp=w.cntrsCount
	else if(!tp)tp=sel.top;while(!dy[tp] && tp>0)tp--
	var ds=w.dataset={},arcs=app.selection.arcs=[];
	//if(!w.paletteScale)
		w.paletteScale=d3.scale.linear()
			.domain([
				clr>3?0
				:clr==1?dy[tp].Value
				:clr==2?dy[tp]['%'].replace('\%','')
				:clr==3?dy[tp].Rank
				:0
				,
				clr==4?w.Value
				:clr==5?100
				:clr==1?dy[1].Value
				:clr==3?dy[1].Rank
				:clr==2?dy[1]['%'].replace('\%','')
				:1
				])//minValue,maxValue
			.range(["#EFEFFF","#02386F"]); // blue color
	for(var i=1;i<=tp;i++){
		var c=dy[i],b;if(c){
			ds[c.iso]=c

			arcs.push(b={strokeColor:c.fillColor= w.paletteScale(
			clr==1||clr==4?c.Value
			:clr==2||clr==5?c['%'].replace('\%','')
			//:clr==3?c.Rank
			:c.Rank
			),origin:(out?'KWT':c.iso)//.toLowerCase()
			,destination:(out?c.iso:'KWT')//.toLowerCase()
			}
			)
			var x=app.ll[b.origin]
			if(x){b.origin={
				latitude: x[1],
				longitude: x[0]};
		  }
		  x=app.ll[b.destination]
			if(x){b.destination={
				latitude: x[1],
				longitude: x[0]};
		  }
			console.log(b)
			try{
				x=document.getElementById('td-0-'+wrd+'-'+c.iso);
				if(x)
					x.style.backgroundColor=b.strokeColor

			}catch(ex){console.error(ex,'db2map:init-arcs')}
		}
	}console.log('app.selection.arcs',arcs)
	
	var xp= document.getElementById(wrd)//p&&p[0] ||
		xp.innerHTML=''
	if(!app[wrd+'map'])
		d3.select(window).on('resize', function() {
			app[wrd+'map'].resize();});
	var map=app[wrd+'map']=new Datamap({
		responsive: true,
		element: xp,
		projection: 'mercator', // big world map
		// countries not listed in dataset will be painted with this color
		fills: { defaultFill:  '#F5F5F5'},//'white'
		data: w.dataset,
		geographyConfig: {
			borderColor: function(geo, data) {
				var c=ds[geo.id];return c?
				'black'//c.fillColor
				:'#757575';},//	'#DEDEDE'	//console.log('map:borderColor:',geo,data);
			borderWidth: function(geo, data) {
				var c=ds[geo.id];
				//console.log('map:borderWidth:',c,geo,data);
				return c?2:1;},//3
			highlightBorderWidth: 2,
			// don't change color on mouse hover
			highlightFillColor: function(geo) {
				var x=document.getElementById(
					'tr-'+wrd+'-'
					+(geo.iso||geo.id||
					(geo.properties&&geo.properties.id)||
					(geo.properties&&geo.properties.iso)));
				if(app.tr)app.tr.style.backgroundColor=''
				if(x)(app.tr=x).style.backgroundColor='#ad3e3e'
				
				return geo['fillColor'] || '#F5F5F5';
			},
			// only change border
			highlightBorderColor: '#751313',//'#ad3e3e',//'yellow',//'#B7B7B7',
			// show desired information in tooltip
			popupTemplate: function(geo, data) {
				// don't show tooltip if country don't present in dataset
				if (!data) { return ; }
				// tooltip content
				return ['<div class="hoverinfo">',
					'<strong>', geo.properties.name, '</strong>',
					'<br>Rank: <strong>', data.Rank, '</strong>',
					'<br>Percentage: <strong>', data['%'], '</strong>',
					'<br>Value: <strong>', data.Value, '</strong><br/>',
					wrd,'-',yr,'</div>'].join('');
			}
		}
	});
	d3.select("svg").on("mousedown.log", function() {  console.log(map.projection.invert(d3.mouse(this)));});

	 // Mix and match ways to specify how arcs are drawn
      map.arc(arcs, {
        animationSpeed: 2000 , strokeWidth: 2,stroke:'black'
      });

 }//db2Map

 ,init:window.onload=function(){app.db=app.initDB()
	app.generate()}
}//app

function onClrCatInput(e,t){
	var v=t.value,va=['x','Value','Percentages','Rank','Total-Value','Total-Percentage']
	var n=document.getElementById('colorCatHd')
	n.innerHTML='Coloring categorization: '+va[v];
	console.log('coloring:onInput'
		,app.selection.clr=v
		,document.getElementById('clrSteplist')
		,app.selection.Clr=t);
		//console.log('coloring:onchange',app.selection.clr=this.value,app.selection.Clr=this);
}

function onSldYrInput(e,t){
	var v=t.value
	var n=document.getElementById('hdYr')
	n.innerHTML='Year: '+v;
	app.selection.yr=v;}

function onSldTopInput(e,t){
	var v=t.value
	var n=document.getElementById('hdTop')
	n.innerHTML='Top Countries: '+v;
	app.selection.top=v;}
</script>
<script src="d3.v3.min.js"></script>
<script src="topojson.js"></script>
<script src="datamaps.world.min.js"></script>


<table><tr><td>
<h2 id="hdYr">Year: 2015</h2><input id="yrSlider" type ="range" min ="2009" max="2015" step ="1" value ="2015" list="steplist"
	oninput="onSldYrInput(event,this)" 
	onchange="onSldYrInput(event,this);app.generate()" >
<datalist id="steplist">
    <option>2009</option>
    <option>2010</option>
    <option>2011</option>
    <option>2012</option>
    <option>2013</option>
    <option>2014</option>
    <option>2015</option>
</datalist>
<hr/><h2 id="hdTop">Top Countries: 5</h2>
<input id="tpSlider" type ="range" step ="1" value ="5" list="topSteplist" min="0" max="42"
	oninput="onSldTopInput(event,this)" 
	onchange="onSldTopInput(event,this);app.generate()" >
<datalist id="topSteplist">
    <option>Top 1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
    <option>5</option>
    <option>10</option>
    <option>15</option>
    <option>20</option>
    <option>25</option>
    <option>30</option>
    <option>All</option>
</datalist>
<hr/><h2 id="colorCatHd">Coloring categorization: Value</h2>
<input id="clrSlider" type ="range" step="1" value="1" list="clrSteplist" min="1" max="5"
	oninput="onClrCatInput(event,this)" 
	onchange="onClrCatInput(event,this);app.generate()" >
<datalist id="clrSteplist">
    <option value="1">Value</option>
    <option value="2">Percentages</option>
    <option value="3">Rank</option>
    <option value="4">Total-Value</option>
    <option value="5">Total-Percentage</option>

</datalist>

</td><td>
<!--table><tr><td colspan="2"-->
<h2 id="inwardH">Kuwait Inward Direct Investment Positions US Dollars, by All Reporting Economies Cross-classified by Counterpart Economies
<br/>US Dollars, Millions</h2><!--/td></tr><tr><td-->
<div id="inwardTbl"></div><!--/td><td-->
<div id="inward"></div><!--/td></tr></table-->

<hr/>

<!--table><tr><td colspan="2"-->
<h2 id="outwardH">Kuwait Outward Direct Investment Positions US Dollars, by All Reporting Economies Cross-classified by Counterpart Economies
<br/>US Dollars, Millions</h2><!--/td></tr><tr><td-->
<div id="outwardTbl"></div><!--/td><td-->
<div id="outward"></div><!--/td></tr></table-->

<span style="display:none">
<pre id="inward" style="display:none"
>	2009	2009	2009	2010	2010	2010	2011	2011	2011	2012	2012	2012	2013	2013	2013	2014	2014	2014	2015	2015	2015		Total	ISO
Investment from:	Value	%	Rank	Value	%	Rank	Value	%	Rank	Value	%	Rank	Value	%	Rank	Value	%	Rank	Value	%	Rank			ISO
Bahrain, Kingdom of	1514.4	32.9%	1	1578.5	13.3%	2	1623.1	10.7%	2	765.6	4.2%	2	1008.9	6.3%	2	1117.3	7.1%	2	1016.5	7%	2		8635.3	BHR
Canada	7.7	0.2%	12				26.4	0.2%	11	27.6	0.2%	10											94.7	CAN
Cayman Islands				13.7	0.1%	11	21.3	0.1%	13	8.0	0%	11	8.3	0.1%	11	8.4	0.1%	11	12.3	0.1%	11		129	CYM
China, P.R.: Hong Kong																58.0	0.4%	8	55.9	0.4%	9		121.9	HKG
Egypt																6.2	0%	13	5.4	0%	14		24.6	EGY
France	53.5	1.2%	9	60.8	0.5%	9	55.2	0.4%	9	57.8	0.3%	9	57.1	0.4%	8	58.0	0.4%	8	59.9	0.4%	8		454.3	FRA
Germany				4.5	0%	12	4.6	0%	14	6.9	0%	12	6.3	0%	12	6.3	0%	12	6.2	0%	13		96.8	DEU
India	5.7	0.1%	13				4.4	0%	15	4.7	0%	13	13.1	0.1%	10	5.8	0%	14	6.5	0%	12		105.2	IND
Iran, Islamic Republic of	3.0	0.1%	14	1.2	0%	15	1.2	0%	17	3.3	0%	14	3.4	0%	13	1.2	0%	15	1.2	0%	15		102.5	IRN
Japan	107.3	2.3%	7	112.3	0.9%	7	114.2	0.8%	6														353.8	JPN
Jersey	91.8	2%	8	96.2	0.8%	8	96.7	0.6%	7	116.7	0.6%	6	104.5	0.6%	6	131.0	0.8%	7	146.1	1%	6		825	JEY
Korea, Republic of	25.8	0.6%	10	45.8	0.4%	10	46.3	0.3%	10	60.0	0.3%	8	48.9	0.3%	9	45.0	0.3%	10	29.0	0.2%	10		357.8	KOR
Lebanon	15.6	0.3%	11	1.6	0%	14	22.1	0.1%	12	0.5	0%	16											92.8	LBN
Oman	291.7	6.3%	5	352.7	3%	5	458.6	3%	5	432.7	2.4%	5	484.6	3%	5	522.9	3.3%	5	479.6	3.3%	5		3052.8	OMN
Qatar	1461.8	31.8%	2	2553.8	21.5%	1	4133.1	27.2%	1	7170.4	39.5%	1	6205.3	38.5%	1	5251.2	33.4%	1	4431.8	30.3%	1		31214.4	QAT
Saudi Arabia	420.9	9.1%	4	520.0	4.4%	4	561.1	3.7%	4	555.5	3.1%	4	595.6	3.7%	4	624.0	4%	4	614.8	4.2%	4		3915.9	SAU
United Arab Emirates	483.0	10.5%	3	569.1	4.8%	3	624.8	4.1%	3	576.2	3.2%	3	639.4	4%	3	664.8	4.2%	3	617.3	4.2%	3		4192.6	ARE
United Kingdom				3.5	0%	13	3.1	0%	16	2.6	0%	15											53.2	GBR
United States	119.6	2.6%	6	121.0	1%	6	62.3	0.4%	8	63.6	0.4%	7	77.7	0.5%	7	131.6	0.8%	6	73.7	0.5%	7		689.5	USA
Not Specified (including Confidential)				5848.6	49.2%		7317.4	48.2%		8292.4	45.7%		6844.2	42.5%		7101.4	45.1%		7047.6	48.3%			42451.6	BLM
World	4601.8	100%		11883.5	100%		15176.0	100%		18144.3	100%		16097.1	100%		15733.0	100%		14603.8	100%			96239.5	SJM
</pre>
<pre id="outward" style="display:none"
>	2009	2009	2009	2010	2010	2010	2011	2011	2011	2012	2012	2012	2013	2013	2013	2014	2014	2014	2015	2015	2015		Total	ISO
Investment in:	Value	%	Rank	Value	%	Rank	Value	%	Rank	Value	%	Rank	Value	%	Rank	Value	%	Rank	Value	%	Rank			ISO
Algeria	831.9	3.9%	10	839.4	3%	10	863.3	2.7%	13	868.3	2.8%	13	936.3	2.5%	13	916.7	2.7%	13	511.3	1.6%	15		5839.2	DZA
Azerbaijan, Republic of							5.9	0%	38				5.8	0%	32								81.7	AZE
Bahamas, The							24.6	0.1%	34														58.6	BHS
Bahrain, Kingdom of	3280.7	15.6%	3	3324	11.8%	3	3907.3	12.1%	1	3470.3	11.2%	2	3354.8	9%	4	3314.7	9.7%	4	3491	11.1%	4		24159.8	BHR
Belgium							61.8	0.2%	28														89.8	BEL
Canada							27.3	0.1%	33														60.3	CAN
Cayman Islands	397	1.9%	14	783.4	2.8%	12	1072.2	3.3%	10	1014.3	3.3%	10	6177.3	16.6%	1	4760.8	13.9%	2	3986.7	12.6%	2		18240.7	CYM
China, P.R.: Hong Kong													0.8	0%	35	2.8	0%	32	1.8	0%	33		72.4	HKG
China, P.R.: Mainland	43.5	0.2%	28	0.1	0%	32	285	0.9%	18														406.6	CHN
Denmark				5.7	0%	31	4.5	0%	39	10	0%	33	23.3	0.1%	29								175.5	DNK
Egypt	1144.7	5.4%	5	1190.8	4.2%	7	1343.2	4.2%	7	1009.4	3.3%	11	963.3	2.6%	12	1129.9	3.3%	11	1226.9	3.9%	8		8061.2	EGY
France	45.1	0.2%	27				83.4	0.3%	27	32.6	0.1%	28	47.2	0.1%	26	23.6	0.1%	30	19.2	0.1%	30		389.1	FRA
Germany	45.5	0.2%	26	45	0.2%	28	52.3	0.2%	31	192.9	0.6%	20	188.6	0.5%	20	158.7	0.5%	21	69.4	0.2%	23		898.4	DEU
Guernsey	122.3	0.6%	19	133.7	0.5%	19	129.8	0.4%	25	130.8	0.4%	24											603.6	GGY
India							7.2	0%	37	15.4	0%	32	5.3	0%	33	29.6	0.1%	29	21.6	0.1%	29		210.1	IND
Indonesia	25.8	0.1%	30	51.1	0.2%	26	60.8	0.2%	29	4.3	0%	34	142.7	0.4%	22	136.8	0.4%	23	113.9	0.4%	22		699.4	IDN
Iraq	1173.8	5.6%	4	3346.5	11.9%	2	2946.4	9.1%	4	3250.1	10.5%	3	3404.4	9.2%	3	3469	10.1%	3	3558.9	11.3%	3		21168.1	IRQ
Isle of Man				45.8	0.2%	27	43.1	0.1%	32	96.2	0.3%	26	68.4	0.2%	24	63.6	0.2%	25	58.8	0.2%	26		509.9	IMN
Jersey	178.4	0.8%	17	163.2	0.6%	16	164.2	0.5%	22	164.3	0.5%	21	37.2	0.1%	28	52.3	0.2%	26	62.8	0.2%	24		952.4	JEY
Jordan	1028.7	4.9%	6	1560.8	5.5%	6	1546.1	4.8%	6	1282.2	4.1%	7	1326.9	3.6%	7	1571.1	4.6%	7	1124.5	3.6%	10		9479.3	JOR
Lebanon	102.1	0.5%	20	85.8	0.3%	23	180.8	0.6%	20	87.7	0.3%	27	236.1	0.6%	19	231.3	0.7%	19	220.5	0.7%	18		1272.3	LBN
Luxembourg	2.4	0%	32	0.1	0%	32	0.1	0%	41	0.1	0%	36	0.1	0%	37	0.1	0%	36					216.9	LUX
Malaysia	751.2	3.6%	11	875.4	3.1%	9	769.4	2.4%	14	528	1.7%	17	601.7	1.6%	16	679.4	2%	14	822.5	2.6%	13		5108.6	MYS
Maldives	87.9	0.4%	23	128.4	0.5%	21	137.4	0.4%	23	144.3	0.5%	22											587	MDV
Malta							735.9	2.3%	15	746	2.4%	14	158.7	0.4%	21	130.8	0.4%	24	59.8	0.2%	25		1905.2	MLT
Mauritania																186.5	0.5%	20	163.8	0.5%	20		370.3	MRT
Morocco	220.5	1%	16	143.5	0.5%	18	207.5	0.6%	19	194.9	0.6%	19	285.7	0.8%	17	286.4	0.8%	17	281.3	0.9%	16		1725.8	MAR
Netherlands	3389.8	16.1%	1	2257.3	8%	5	3396.8	10.5%	3	956.1	3.1%	12	1085	2.9%	10	1060.1	3.1%	12	1020.1	3.2%	11		13208.2	NLD
Netherlands Antilles	0.4	0%	34																				34.4	ANT
Norway																2.4	0%	33	2.3	0%	32		37.7	NOR
Oman	164.2	0.8%	18	154.1	0.5%	17	176.8	0.5%	21	213.5	0.7%	18	285.1	0.8%	18	260.9	0.8%	18	252	0.8%	17		1616.6	OMN
Pakistan	99.3	0.5%	21	126.3	0.4%	22	133.1	0.4%	24	141.2	0.5%	23	122.7	0.3%	23	147.7	0.4%	22	164	0.5%	19		1069.3	PAK
Panama				12.9	0%	30	18.7	0.1%	35	18.5	0.1%	31	18.7	0.1%	30								194.8	PAN
Qatar	999.5	4.7%	7	417.9	1.5%	14	501.4	1.6%	16	745.8	2.4%	15	786.5	2.1%	14	608.3	1.8%	16	135.4	0.4%	21		4276.8	QAT
Saudi Arabia	3311.8	15.7%	2	3639.2	12.9%	1	3662.2	11.4%	2	4364.5	14.1%	1	5395.5	14.5%	2	5126.4	14.9%	1	4672.9	14.8%	1		30181.5	SAU
Singapore	14.8	0.1%	31	14.3	0.1%	29	17.6	0.1%	36	31.9	0.1%	29	37.8	0.1%	27	46.3	0.1%	27	56.4	0.2%	27		398.1	SGP
South Africa							0.9	0%	40	0.9	0%	35	0.7	0%	36	0.6	0%	35					149.1	ZAF
Sudan	660.9	3.1%	12	2482.7	8.8%	4	868	2.7%	12	1196.5	3.9%	8	1275.5	3.4%	8	1421.3	4.1%	8	1214.6	3.8%	9		9171.5	SDN
Switzerland	59.9	0.3%	25																				84.9	CHE
Syrian Arab Republic	34.3	0.2%	29	57.8	0.2%	25	60.8	0.2%	29	21.1	0.1%	30	1.4	0%	34	1.2	0%	34	1.1	0%	34		358.7	SYR
Tunisia	222.6	1.1%	15	416.1	1.5%	15	1953.7	6.1%	5	2022.9	6.5%	4	2122.8	5.7%	5	1774.8	5.2%	6	1565.7	5%	6		10128.6	TUN
Turkey	470.5	2.2%	13	691.7	2.5%	13	1203.1	3.7%	8	1432.8	4.6%	6	1551.3	4.2%	6	2089.9	6.1%	5	1947.4	6.2%	5		9437.7	TUR
United Arab Emirates	847	4%	9	794	2.8%	11	922.4	2.9%	11	1436.1	4.6%	5	1065.3	2.9%	11	1215.3	3.5%	9	1532.8	4.9%	7		7868.9	ARE
United Kingdom	940.1	4.5%	8	940.3	3.3%	8	1120	3.5%	9	1169.7	3.8%	9	1253.3	3.4%	9	1135.1	3.3%	10	991.2	3.1%	12		7602.7	GBR
United States	85.1	0.4%	24	70.3	0.2%	24	360.4	1.1%	17	717.3	2.3%	16	634.6	1.7%	15	661.2	1.9%	15	741.6	2.3%	14		3381.5	USA
Virgin Islands, British	0	0%	35	0	0%	34	0	0%	42	0	0%	37	10	0%	31	10.6	0%	31	9.1	0%	31		239.7	VGB
West Bank and Gaza	93.8	0.4%	22	130.7	0.5%	20	127.5	0.4%	26	126.3	0.4%	25	50.6	0.1%	25	39	0.1%	28	33.1	0.1%	28		747	PSE
Yemen, Republic of	0.7	0%	33																				33.7	YEM
Not Specified (including Confidential)	216	1%		3260.7	11.6%		3067.3	9.5%		3186.2	10.3%		3491	9.4%		1564.6	4.6%		1442.7	4.6%			16228.5	BLM
World	21092.3	100%		28189.2	100%		32250.4	100%		31023.3	100%		37152.5	100%		34309.4	100%		31577.1	100%			215594.2	SJM
</pre>
</span>
<style>
h2,th {font-size:large}
    body {
      font: 24px monospace
    }

    table {
      margin: 10px;
      font-size: 24px;
    }

    td {
      padding: 5px;
      border-bottom: 1px solid black;
    }

    td.update { 
      color: blue;
    }

    td.enter {
      color: green;
    }

    td.exit, tr.exit td {
      color: red;
    }

    td.row-header {
      border-right: 1px solid black;
      font-weight: bold;
    }

  </style>
  </td></tr></table>